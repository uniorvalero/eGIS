import{a as vt,b as Ot}from"./chunk-TYCUJ3AA.js";import{a as Mt,b as St}from"./chunk-SL3KMOUJ.js";import{c as U,e as Pt}from"./chunk-2IGJZFV7.js";import{c as st}from"./chunk-KGOMAVQY.js";import{a as S,b as dt,c as ft,e as ut,f as gt,h as ht,i as bt,k as _t,l as Ct,n as yt,o as xt,p as wt,q as T}from"./chunk-NFABPVPM.js";import"./chunk-SYAC655V.js";import"./chunk-ECBSDO4K.js";import{a as rt,b as lt}from"./chunk-DQWGBFJK.js";import"./chunk-MS4AQ6UA.js";import{a as pt,b as ct}from"./chunk-LB6LRJVS.js";import{c as ot,f as mt}from"./chunk-YBNMVR6Q.js";import{a as K,b as X,c as Z}from"./chunk-AWMIQM5V.js";import"./chunk-O27SARHL.js";import"./chunk-SGYCFQGT.js";import{a as it}from"./chunk-HSUA2CKH.js";import{a as H}from"./chunk-TMATL23G.js";import{b as $,g as j,h as Q,ha as tt,i as G,k as M,m as q,oa as et,p as W,q as Y,ta as at,ua as nt,x as J}from"./chunk-FPYKYBTQ.js";import{Db as i,Eb as n,Fb as _,Gb as u,Hb as g,Jb as y,Lb as h,Mb as b,Nc as V,Qb as x,Qc as F,Rb as w,Rc as z,Sb as P,Vb as I,Wb as r,Y as D,Ya as m,Yb as C,ba as E,bb as k,dc as A,gc as B,ib as R,ic as L,jc as N,ka as s,la as d,nb as f,ub as p}from"./chunk-NKHI3LCY.js";var v=class a{constructor(t){this.http=t}apibaseurl=it.toimsApiBaseURL;getAllPayments(){return this.http.get(this.apibaseurl+"/UtilityBPLTAS/GetByStatus?status=Paid")}getPaymentsByReceiptRange(t,e){return this.http.get(`${this.apibaseurl}/UtilityBPLTAS/ReceiptRange`,{params:{start:t.toString(),end:e.toString()}})}updatePayments(t){return this.http.put(`${this.apibaseurl+"/UtilityBPLTAS"}/${t.id}`,t)}batchUpdatePayments(t){return this.http.put(`${this.apibaseurl}/UtilityBPLTAS/BatchUpdate`,t)}createCollection(t){return this.http.post(this.apibaseurl+"/UtilityBPLTAS/Create",t)}static \u0275fac=function(e){return new(e||a)(E(H))};static \u0275prov=D({token:a,factory:a.\u0275fac,providedIn:"root"})};var Ut=()=>[5,10,25,100];function Dt(a,t){if(a&1){let e=y();i(0,"th",35)(1,"mat-checkbox",36),h("change",function(l){s(e);let c=b();return d(l?c.masterToggle():null)}),n()()}if(a&2){let e=b();m(),p("checked",e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected())}}function Et(a,t){if(a&1){let e=y();i(0,"td",37)(1,"mat-checkbox",38),h("click",function(l){return s(e),d(l.stopPropagation())})("change",function(l){let c=s(e).$implicit,O=b();return d(l?O.selection.toggle(c):null)}),n()()}if(a&2){let e=t.$implicit,o=b();m(),p("checked",o.selection.isSelected(e))}}function Rt(a,t){a&1&&(i(0,"th",35),r(1," Action "),n())}function It(a,t){if(a&1){let e=y();i(0,"td",39)(1,"button",40),h("click",function(){let l=s(e).$implicit,c=b();return d(c.onProcess(l))}),i(2,"mat-icon"),r(3,"open_in_new"),n()()()}}function At(a,t){a&1&&(i(0,"th",41),r(1," Receipt No "),n())}function Lt(a,t){if(a&1&&(i(0,"td",37),r(1),n()),a&2){let e=t.$implicit;m(),C(" ",e.receiptNo," ")}}function Nt(a,t){a&1&&(i(0,"th",41),r(1," Payment Method "),n())}function Vt(a,t){if(a&1&&(i(0,"td",37),r(1),n()),a&2){let e=t.$implicit;m(),C(" ",e.typesOfPayment," ")}}function Ft(a,t){a&1&&(i(0,"th",41),r(1," Payment Date "),n())}function zt(a,t){if(a&1&&(i(0,"td",37),r(1),B(2,"date"),n()),a&2){let e=t.$implicit;m(),C(" ",L(2,1,e.paymentDate,"short")," ")}}function Ht(a,t){a&1&&(i(0,"th",41),r(1," Amount Paid "),n())}function $t(a,t){if(a&1&&(i(0,"td",37),r(1),B(2,"currency"),n()),a&2){let e=t.$implicit;m(),C(" ",N(2,1,e.amount,"PHP",!0)," ")}}function jt(a,t){a&1&&_(0,"tr",42)}function Qt(a,t){a&1&&_(0,"tr",43)}function Gt(a,t){if(a&1&&(i(0,"tr",44)(1,"td",45),r(2),n()()),a&2){b();let e=I(31);m(2),C('No data matching the filter "',e.value,'"')}}var kt=class a{constructor(t,e){this.dialog=t;this.utilitybpltasService=e}rangeForm=new G({type:new M("total"),startingRange:new M(""),endingRange:new M("")});selection=new ot(!0,[]);displayedColumns=["select","actions","receiptNo","typesOfPayment","paymentDate","amount"];dataSource;paginator;sort;table;ngOnInit(){this.loadUtility()}loadUtility(){this.utilitybpltasService.getAllPayments().subscribe(t=>{this.dataSource=new T(t),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}loadBatch(){let t=Number(this.rangeForm.get("startingRange")?.value),e=Number(this.rangeForm.get("endingRange")?.value);console.log("start"+t,"end"+e),!(isNaN(t)||isNaN(e))&&this.utilitybpltasService.getPaymentsByReceiptRange(t,e).subscribe(o=>{this.dataSource=new T(o),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}isAllSelected(){let t=this.selection.selected.length,e=this.dataSource?.data.length||0;return t===e}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.data.forEach(t=>this.selection.select(t))}onProcess(t){this.dialog.open(vt,{data:{message:'Mark this payment as "For Collection"?'}}).afterClosed().subscribe(o=>{o&&(t.status="For Collection",this.utilitybpltasService.updatePayments(t).subscribe(()=>{this.dataSource.data=[...this.dataSource.data]}))})}onBatchUpdate(){let t=this.selection.selected;if(t.length===0){alert("No payments selected for batch update.");return}this.dialog.open(Ot,{data:{message:'Mark selected payments as "For Collection"?'}}).afterClosed().subscribe(o=>{o&&(t.forEach(l=>l.status="For Collection"),this.utilitybpltasService.batchUpdatePayments(t).subscribe(()=>{this.dataSource.data=[...this.dataSource.data],this.selection.clear()}))})}applyFilter(t){let e=t.target.value;this.dataSource.filter=e.trim().toLocaleLowerCase()}static \u0275fac=function(e){return new(e||a)(k(st),k(v))};static \u0275cmp=R({type:a,selectors:[["app-bpltas-utility"]],viewQuery:function(e,o){if(e&1&&(x(U,5),x(Pt,5),x(S,5)),e&2){let l;w(l=P())&&(o.paginator=l.first),w(l=P())&&(o.sort=l.first),w(l=P())&&(o.table=l.first)}},decls:61,vars:7,consts:[["input",""],[1,"table-container"],[1,"text-2xl","font-bold"],[3,"formGroup"],[1,"filter-container"],[1,"large-dropdown"],["formControlName","type"],["value","total"],[1,"range-row"],["appearance","fill",1,"flex-1"],["matInput","","formControlName","startingRange"],[1,"range-separator"],["matInput","","formControlName","endingRange"],["mat-raised-button","","color","primary",1,"load-batch-btn",3,"click"],[1,"full-width"],["matInput","","placeholder","Search Utilities..",3,"keyup"],[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","actions"],["mat-cell","","class","space-x-2",4,"matCellDef"],["matColumnDef","receiptNo"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","typesOfPayment"],["matColumnDef","paymentDate"],["matColumnDef","amount"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[1,"paginator-row"],[1,"batch-btn-container"],["mat-icon-button","","color","primary","matTooltip","Batch Update",3,"click","disabled"],["aria-label","Select page of users",3,"pageSizeOptions"],["mat-header-cell",""],[3,"change","checked","indeterminate"],["mat-cell",""],[3,"click","change","checked"],["mat-cell","",1,"space-x-2"],["mat-icon-button","","color","primary","matTooltip","Process",3,"click"],["mat-header-cell","","mat-sort-header",""],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(e,o){if(e&1){let l=y();i(0,"div",1)(1,"div")(2,"h1",2),r(3,"BPLTAS UTILITIES"),n()(),r(4," \xA0 "),i(5,"form",3)(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),r(9,"Select..."),n(),i(10,"mat-select",6)(11,"mat-option",7),r(12,"Total Business Permit per Receipt"),n()()()(),i(13,"div",8)(14,"mat-form-field",9)(15,"mat-label"),r(16,"Starting Range"),n(),_(17,"input",10),n(),i(18,"span",11),r(19,"-"),n(),i(20,"mat-form-field",9)(21,"mat-label"),r(22,"Ending Range"),n(),_(23,"input",12),n(),i(24,"button",13),h("click",function(){return s(l),d(o.loadBatch())}),r(25,"Load Batch"),n()()(),i(26,"div")(27,"mat-form-field",14)(28,"mat-label"),r(29,"Filter"),n(),i(30,"input",15,0),h("keyup",function(O){return s(l),d(o.applyFilter(O))}),n()()(),i(32,"div",16)(33,"table",17),u(34,18),f(35,Dt,2,2,"th",19)(36,Et,2,1,"td",20),g(),u(37,21),f(38,Rt,2,0,"th",19)(39,It,4,0,"td",22),g(),u(40,23),f(41,At,2,0,"th",24)(42,Lt,2,1,"td",20),g(),u(43,25),f(44,Nt,2,0,"th",24)(45,Vt,2,1,"td",20),g(),u(46,26),f(47,Ft,2,0,"th",24)(48,zt,3,4,"td",20),g(),u(49,27),f(50,Ht,2,0,"th",24)(51,$t,3,5,"td",20),g(),f(52,jt,1,0,"tr",28)(53,Qt,1,0,"tr",29)(54,Gt,3,1,"tr",30),n(),i(55,"div",31)(56,"div",32)(57,"button",33),h("click",function(){return s(l),d(o.onBatchUpdate())}),i(58,"mat-icon"),r(59,"playlist_add_check"),n()()(),_(60,"mat-paginator",34),n()()()}e&2&&(m(5),p("formGroup",o.rangeForm),m(28),p("dataSource",o.dataSource),m(19),p("matHeaderRowDef",o.displayedColumns),m(),p("matRowDefColumns",o.displayedColumns),m(4),p("disabled",!o.selection.hasValue()),m(3),p("pageSizeOptions",A(6,Ut)))},dependencies:[et,nt,at,tt,wt,S,ft,bt,ut,dt,_t,gt,ht,Ct,yt,xt,lt,rt,U,Z,X,K,z,F,V,ct,pt,mt,St,Mt,J,q,$,j,Q,W,Y],styles:[".table-container[_ngcontent-%COMP%]{border:1.5px solid #e0e0e0;border-radius:10px;padding:24px;background:transparent;box-shadow:none}  .mat-paginator,   .mat-paginator-container,   .mat-paginator-outer-container,   .mat-paginator-range-actions,   .mat-paginator-page-size,   .mat-paginator-page-size-label,   .mat-paginator-range-label,   .mat-paginator-navigation-previous,   .mat-paginator-navigation-next,   .mat-paginator-page-size-select,   .mat-paginator-page-size-select .mat-select-trigger,   .mat-paginator-page-size-select .mat-select-value,   .paginator-row,   div[style*=background],   .mat-mdc-paginator,   .mat-mdc-paginator-container,   .mat-mdc-paginator-range-actions{background:transparent!important;box-shadow:none!important}  .mat-paginator,   .mat-paginator-container,   .mat-paginator-outer-container,   .mat-mdc-paginator,   .mat-mdc-paginator-container{background:transparent!important;box-shadow:none!important;border:1.5px!important}table[_ngcontent-%COMP%], thead[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%], tr[_ngcontent-%COMP%], th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{background:transparent!important}.mat-elevation-z8[_ngcontent-%COMP%], .mat-table[_ngcontent-%COMP%], .mat-header-row[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%], .mat-header-cell[_ngcontent-%COMP%], .mat-cell[_ngcontent-%COMP%], tr[_ngcontent-%COMP%], td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{background:transparent!important;box-shadow:none!important}.mat-row[_ngcontent-%COMP%]:nth-child(2n), .mat-row[_ngcontent-%COMP%]:nth-child(odd){background:transparent!important}.mat-header-row[_ngcontent-%COMP%], .mat-footer-row[_ngcontent-%COMP%], .mat-header-cell[_ngcontent-%COMP%], .mat-footer-cell[_ngcontent-%COMP%]{background:transparent!important}.mat-header-row[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%]{border-bottom:1px solid #bdbdbd}.mat-header-cell[_ngcontent-%COMP%], .mat-cell[_ngcontent-%COMP%]{border-right:1px solid #e0e0e0}.mat-header-cell[_ngcontent-%COMP%]:last-child, .mat-cell[_ngcontent-%COMP%]:last-child{border-right:none}.mat-row[_ngcontent-%COMP%]:hover, tr[_ngcontent-%COMP%]:hover, .mat-row.cdk-focused[_ngcontent-%COMP%], .mat-row.cdk-mouse-focused[_ngcontent-%COMP%]{background:transparent!important}  .mat-header-cell{background-color:#3f51b5;color:#fff;font-weight:700;font-size:16px;text-align:center}  .mat-header-row{height:56px}.full-width[_ngcontent-%COMP%]{width:100%}.dashboard-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:12px;flex-wrap:wrap}.paginator-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-top:8px;background:transparent;box-shadow:none}.batch-btn-container[_ngcontent-%COMP%]{width:48px;display:flex;justify-content:center}button[mat-icon-button][disabled][_ngcontent-%COMP%]{opacity:.5;pointer-events:none}.range-row[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{height:40px;background:transparent!important;box-shadow:none!important}.range-row[_ngcontent-%COMP%]   .mat-input-element[_ngcontent-%COMP%]{height:40px;line-height:40px;padding:0 8px;font-size:16px;width:40px;background:transparent!important;box-shadow:none!important}.range-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;margin-bottom:24px;width:50%;background:transparent!important;box-shadow:none!important}.range-row[_ngcontent-%COMP%]   .flex-1[_ngcontent-%COMP%]{flex:1;min-width:120px}.range-separator[_ngcontent-%COMP%]{margin:0 8px;font-weight:700;font-size:18px}.load-batch-btn[_ngcontent-%COMP%]{height:50px;min-width:120px;margin-left:8px;background:#4169e1!important;color:#fff!important;font-weight:600;font-size:16px;border-radius:8px;box-shadow:0 2px 8px #4169e126;transition:background .2s,box-shadow .2s,transform .1s;letter-spacing:.5px;border:none;display:flex;align-items:left;justify-content:center;padding:0 24px;margin-bottom:24px}.load-batch-btn[_ngcontent-%COMP%]:hover, .load-batch-btn[_ngcontent-%COMP%]:focus{background:#274bb5!important;box-shadow:0 4px 16px #4169e140;transform:translateY(-2px) scale(1.03)}.large-dropdown[_ngcontent-%COMP%]{width:50%;min-width:250px;font-size:18px}.large-dropdown[_ngcontent-%COMP%]   .mat-select-value[_ngcontent-%COMP%]{font-size:18px}  .mat-form-field-appearance-fill .mat-form-field-flex,   .mat-form-field-appearance-fill .mat-form-field-infix,   .mat-form-field-appearance-fill .mat-form-field-outline,   .mat-form-field-wrapper,   .mat-form-field-flex,   .mat-form-field-infix,   .mat-input-element,   .mat-select-trigger,   .mat-select-value,   .mat-select,   input.mat-input-element,   textarea.mat-input-element{background:transparent!important;box-shadow:none!important}  .mat-form-field-appearance-fill .mat-form-field-outline{background:transparent!important;border:none!important}  .mat-select-trigger,   .mat-select-value,   .mat-select{background:transparent!important;box-shadow:none!important}  .mat-select-panel{background:transparent!important;box-shadow:none!important}  .mat-option,   .mat-option.mat-active,   .mat-option.mat-selected,   .mat-option:hover{background:transparent!important}  .mat-form-field-appearance-fill{background:transparent!important}  .mat-form-field-wrapper,   .mat-form-field{background:transparent!important}.range-row[_ngcontent-%COMP%], .large-dropdown[_ngcontent-%COMP%]{background:transparent!important}  .mat-form-field-appearance-fill .mat-form-field-flex:before{background:transparent!important}  .mat-form-field-appearance-fill .mat-form-field-flex:hover:before,   .mat-form-field-appearance-fill .mat-form-field-flex.mat-focused:before{background:transparent!important}  .mat-form-field-appearance-fill .mat-form-field-outline,   .mat-form-field-appearance-fill .mat-form-field-outline-thick,   .mat-form-field-appearance-fill .mat-form-field-outline-start,   .mat-form-field-appearance-fill .mat-form-field-outline-gap,   .mat-form-field-appearance-fill .mat-form-field-outline-end,   .mat-form-field-appearance-fill fieldset,   .mat-form-field-appearance-fill legend{background:transparent!important;border-color:#0000001f!important}  input.mat-input-element[disabled],   input.mat-input-element[readonly],   .mat-select-disabled .mat-select-value{background:transparent!important}  input.mat-input-element:-webkit-autofill{-webkit-box-shadow:0 0 0 1000px transparent inset!important;box-shadow:0 0 0 1000px transparent inset!important;background:transparent!important}.filter-container[_ngcontent-%COMP%], .mat-form-field[_ngcontent-%COMP%], .mat-form-field-wrapper[_ngcontent-%COMP%]{background:transparent!important}"]})};export{kt as BpltasUtilityComponent};
