import{a as $}from"./chunk-FKZPGAO2.js";import{a as Ue}from"./chunk-IBAYAYJH.js";import{a as U}from"./chunk-GRYVUB4F.js";import{a as ke,b as Fe,c as Oe,h as Pe}from"./chunk-QPQHFBXO.js";import{d as Re,e as Le}from"./chunk-DBLGM7RZ.js";import{a as Ie,b as be,c as Te,e as Ne,h as Ve}from"./chunk-V5IDTODI.js";import{b as re}from"./chunk-LEOWTEI6.js";import"./chunk-F5X5MWHG.js";import"./chunk-MS4AQ6UA.js";import{a as Ae,b as De,c as j,e as we,f as Me,g as Ee}from"./chunk-4QXU7Q3Z.js";import{G as ve,H as ye,I as xe,J as L,e as R,f as le,g as me,i as pe,j as ce,l as de,m as fe,o as ue,p as _e,r as Ce,s as Se,t as ge,u as he}from"./chunk-MYHFZ2D2.js";import"./chunk-3RK6DDJD.js";import{$ as N,b as J,da as oe,g as K,ga as V,h as W,ka as ae,l as X,la as k,ma as F,n as Z,o as ee,p as te,pa as se,q as ie,ra as O,s as ne,sa as P}from"./chunk-KTJ4FNCK.js";import"./chunk-IKLMD3RG.js";import{m as z,n as Y,t as T}from"./chunk-T6TR6RQX.js";import{Bb as o,Cb as n,Db as d,Eb as u,Fb as _,Hb as A,Lb as v,Mb as y,Qb as D,Rb as w,Sb as M,Va as l,Vb as E,Wb as s,Xb as Q,Yb as c,_a as h,ab as q,cc as H,dc as G,fb as b,ia as S,ja as g,lb as m,sb as p,w as I}from"./chunk-5MRHDFKX.js";function Ke(t,e){if(t&1&&(o(0,"mat-option",26),s(1),n()),t&2){let i=e.$implicit;p("value",i.id),l(),c(" ",i.userName," ")}}function We(t,e){if(t&1&&(o(0,"mat-option",26),s(1),n()),t&2){let i=e.$implicit;p("value",i.propertyId),l(),c(" ",i.taxDeclarationNo," ")}}function Xe(t,e){if(t&1){let i=A();o(0,"mat-form-field",6)(1,"mat-label"),s(2,"Select Tax Declaration No"),n(),o(3,"mat-select",27),v("selectionChange",function(r){S(i);let f=y();return g(f.onSelectedTax(r.value))}),m(4,We,2,2,"mat-option",8),n()()}if(t&2){let i=y();l(4),p("ngForOf",i.ownerProperties)}}function Ze(t,e){if(t&1&&(o(0,"mat-option",26),s(1),n()),t&2){let i=e.$implicit;p("value",i.id),l(),c(" ",i.userName," ")}}var B=class t{constructor(e,i,a,r,f){this.fb=e;this.dialogRef=i;this.data=a;this.usersService=r;this.propertyService=f;this.isEditMode=!!a.propertyId,this.form=this.fb.group({userId:[null],userName:[null],propertyId:[null],propertyLocation:[a.propertyLocation],taxDeclarationNo:[a.taxDeclarationNo],titleNo:[a.titleNo],classification:[a.classification],location:[a.location],landArea:[a.landArea],assessedValue:[a.assessedValue],marketValue:[a.marketValue],assessmentLevel:[a.assessmentLevel],assessmentDate:[a.assessmentDate?new Date(a.assessmentDate):""],validUntil:[a.validUntil?new Date(a.validUntil):null],assessedBy:[null]}),this.loadOwner(),this.loadAssessor()}form;isEditMode;selectedCode;selectedProperty=null;usersOwner=[];usersAssessor=[];selectedOwner=null;selectedAssessor=null;ownerProperties=[];userOwner="Owner";userAssessor="Assessor";loadOwner(){this.usersService.getUserIDName(this.userOwner).subscribe(e=>{this.usersOwner=e})}loadAssessor(){this.usersService.getUserIDName(this.userAssessor).subscribe(e=>{this.usersAssessor=e})}onSelectedOwner(e){let i=this.usersOwner.find(a=>a.id===e);this.selectedOwner=i||null,this.form.patchValue({ownerId:e}),this.propertyService.getAllProperties().subscribe(a=>{this.ownerProperties=a.filter(r=>r.ownerId===e),this.form.patchValue({propertyId:null,propertyLocation:"",taxDeclarationNo:"",titleNo:"",classification:"",location:"",landArea:""})})}onSelectedAssessor(e){let i=this.usersAssessor.find(a=>a.id===e);this.selectedAssessor=i||null,this.form.patchValue({assessedBy:e}),console.log("Selected Assessor:",this.selectedAssessor)}onSelectedTax(e){let i=this.ownerProperties.find(a=>a.propertyId===e);i&&this.form.patchValue({propertyId:i.propertyId,propertyLocation:i.location,taxDeclarationNo:i.taxDeclarationNo,titleNo:i.titleNo,classification:i.classification,location:i.location,landArea:i.landArea})}onSubmit(){if(this.form.valid){let e=this.form.value;if(e.assessmentDate instanceof Date){let i=e.assessmentDate.getFullYear(),a=String(e.assessmentDate.getMonth()+1).padStart(2,"0"),r=String(e.assessmentDate.getDate()).padStart(2,"0");e.assessmentDate=`${i}-${a}-${r}`}if(e.validUntil instanceof Date){let i=e.validUntil.getFullYear(),a=String(e.validUntil.getMonth()+1).padStart(2,"0"),r=String(e.validUntil.getDate()).padStart(2,"0");e.validUntil=`${i}-${a}-${r}`}this.dialogRef.close(e)}}onCancel(){this.dialogRef.close()}static \u0275fac=function(i){return new(i||t)(h(ie),h(Ie),h(be),h(U),h($))};static \u0275cmp=b({type:t,selectors:[["app-assessments-dialog"]],features:[H([Le()])],decls:75,vars:11,consts:[["validpicker",""],["picker",""],[1,"container-fluid"],["mat-dialog-title",""],[1,"form-container",3,"ngSubmit","formGroup"],[1,"form-grid"],[1,"full-width"],["formControlName","userId",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["class","full-width",4,"ngIf"],["matInput","","formControlName","propertyId","readonly",""],["matInput","","formControlName","propertyLocation","readonly",""],["matInput","","formControlName","taxDeclarationNo","readonly",""],["matInput","","formControlName","titleNo","readonly",""],["matInput","","formControlName","classification","readonly",""],["matInput","","formControlName","location","readonly",""],["matInput","","formControlName","landArea","readonly",""],["matInput","","formControlName","assessedValue","required",""],["matInput","","formControlName","marketValue","required",""],["matInput","","formControlName","assessmentLevel","required",""],["matInput","","formControlName","validUntil",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","formControlName","assessmentDate",3,"matDatepicker"],[1,"dialog-actions"],["mat-button","","type","button",3,"click"],["mat-raised-button","","type","submit",3,"disabled"],[3,"value"],["formControlName","propertyId",3,"selectionChange"]],template:function(i,a){if(i&1){let r=A();o(0,"div",2)(1,"h2",3),s(2),n(),o(3,"form",4),v("ngSubmit",function(){return S(r),g(a.onSubmit())}),o(4,"div",5)(5,"mat-form-field",6)(6,"mat-label"),s(7,"Select property owner"),n(),o(8,"mat-select",7),v("selectionChange",function(C){return S(r),g(a.onSelectedOwner(C.value))}),m(9,Ke,2,2,"mat-option",8),n()(),m(10,Xe,5,1,"mat-form-field",9),o(11,"mat-form-field",6)(12,"mat-label"),s(13,"Property ID"),n(),d(14,"input",10),n(),o(15,"mat-form-field",6)(16,"mat-label"),s(17,"Property Location"),n(),d(18,"input",11),n(),o(19,"mat-form-field",6)(20,"mat-label"),s(21,"Tax Declaration No"),n(),d(22,"input",12),n(),o(23,"mat-form-field",6)(24,"mat-label"),s(25,"Title No"),n(),d(26,"input",13),n(),o(27,"mat-form-field",6)(28,"mat-label"),s(29,"Classification"),n(),d(30,"input",14),n(),o(31,"mat-form-field",6)(32,"mat-label"),s(33,"Location"),n(),d(34,"input",15),n(),o(35,"mat-form-field",6)(36,"mat-label"),s(37,"Land Area"),n(),d(38,"input",16),n(),o(39,"mat-form-field",6)(40,"mat-label"),s(41,"Assessed Value"),n(),d(42,"input",17),n(),o(43,"mat-form-field",6)(44,"mat-label"),s(45,"Market Value"),n(),d(46,"input",18),n(),o(47,"mat-form-field",6)(48,"mat-label"),s(49,"Assessment Level"),n(),d(50,"input",19),n(),o(51,"mat-form-field",6)(52,"mat-label"),s(53,"Select assessor"),n(),o(54,"mat-select",7),v("selectionChange",function(C){return S(r),g(a.onSelectedAssessor(C.value))}),m(55,Ze,2,2,"mat-option",8),n()(),o(56,"mat-form-field",6)(57,"mat-label"),s(58,"Valid Until"),n(),d(59,"input",20)(60,"mat-datepicker-toggle",21)(61,"mat-datepicker",null,0),n(),o(63,"mat-form-field",6)(64,"mat-label"),s(65,"Assessment Date"),n(),d(66,"input",22)(67,"mat-datepicker-toggle",21)(68,"mat-datepicker",null,1),n()(),o(70,"div",23)(71,"button",24),v("click",function(){return S(r),g(a.onCancel())}),s(72,"Cancel"),n(),o(73,"button",25),s(74),n()()()()}if(i&2){let r=E(62),f=E(69);l(2),c("",a.isEditMode?"Edit":"Add"," Assessment"),l(),p("formGroup",a.form),l(6),p("ngForOf",a.usersOwner),l(),p("ngIf",a.ownerProperties.length>0),l(45),p("ngForOf",a.usersAssessor),l(4),p("matDatepicker",r),l(),p("for",r),l(6),p("matDatepicker",f),l(),p("for",f),l(6),p("disabled",!a.form.valid),l(),Q(a.isEditMode?"Update":"Create")}},dependencies:[ne,X,J,K,W,te,Z,ee,ae,V,N,oe,T,z,Y,F,k,re,L,xe,ve,P,O,Ve,Ne,Re,Pe,ke,Fe,Oe],styles:[".form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;align-items:center;justify-content:center;height:100%;padding:10px}.full-width[_ngcontent-%COMP%]{width:100%}mat-dialog-content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:200px}mat-dialog-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}mat-form-field[_ngcontent-%COMP%]{width:100%;padding:10px}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:16px}.dialog-actions[_ngcontent-%COMP%]{margin-top:24px;display:flex;justify-content:flex-end;gap:12px}"],changeDetection:0})};var et=["dynamicComponentContainer"],tt=()=>[5,10,25,100];function it(t,e){t&1&&(o(0,"th",29),s(1," ID "),n())}function nt(t,e){if(t&1&&(o(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.propertyId," ")}}function ot(t,e){t&1&&(o(0,"th",29),s(1," Assessment ID "),n())}function at(t,e){if(t&1&&(o(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.assessmentId," ")}}function st(t,e){t&1&&(o(0,"th",29),s(1," Property Location "),n())}function rt(t,e){if(t&1&&(o(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.propertyLocation," ")}}function lt(t,e){t&1&&(o(0,"th",29),s(1," Tax Declaration No "),n())}function mt(t,e){if(t&1&&(o(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.taxDeclarationNo," ")}}function pt(t,e){t&1&&(o(0,"th",29),s(1," Title No "),n())}function ct(t,e){if(t&1&&(o(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.titleNo," ")}}function dt(t,e){t&1&&(o(0,"th",29),s(1," Classification "),n())}function ft(t,e){if(t&1&&(o(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.classification," ")}}function ut(t,e){t&1&&(o(0,"th",29),s(1," Location "),n())}function _t(t,e){if(t&1&&(o(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.location," ")}}function Ct(t,e){t&1&&(o(0,"th",29),s(1," Land Area "),n())}function St(t,e){if(t&1&&(o(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.landArea," ")}}function gt(t,e){t&1&&(o(0,"th",29),s(1," Assessed Value "),n())}function ht(t,e){if(t&1&&(o(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.assessedValue," ")}}function vt(t,e){t&1&&(o(0,"th",29),s(1," Market Value "),n())}function yt(t,e){if(t&1&&(o(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.marketValue," ")}}function xt(t,e){t&1&&(o(0,"th",29),s(1," Assessment Level "),n())}function At(t,e){if(t&1&&(o(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.assessmentLevel," ")}}function Dt(t,e){t&1&&(o(0,"th",29),s(1," Assessed By "),n())}function wt(t,e){if(t&1&&(o(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.assessedBy," ")}}function Mt(t,e){t&1&&(o(0,"th",31),s(1," Action "),n())}function Et(t,e){if(t&1){let i=A();o(0,"td",32)(1,"button",33),v("click",function(){let r=S(i).$implicit,f=y();return g(f.openDialog(r))}),o(2,"mat-icon"),s(3,"edit"),n()(),o(4,"button",34),v("click",function(){let r=S(i).$implicit,f=y();return g(f.deleteAssessment(r.id))}),o(5,"mat-icon"),s(6,"delete"),n()()()}}function It(t,e){t&1&&d(0,"tr",35)}function bt(t,e){t&1&&d(0,"tr",36)}function Tt(t,e){if(t&1&&(o(0,"tr",37)(1,"td",38),s(2),n()()),t&2){y();let i=E(11);l(2),c('No data matching the filter "',i.value,'"')}}var $e=class t{constructor(e,i,a,r){this.assessmentService=e;this.dialog=i;this.propertyService=a;this.usersService=r}showSubCode=!1;displayedColumns=["propertyLocation","taxDeclarationNo","titleNo","classification","landArea","assessedValue","marketValue","assessmentLevel","assessedBy","actions"];dataSource;paginator;sort;table;container;ngOnInit(){this.loadAssessment()}loadAssessment(){this.assessmentService.getAllAssessment().subscribe(e=>{let i=e.map(r=>this.propertyService.getPropertyById(r.propertyId)),a=e.map(r=>r.assessedBy?this.usersService.getUserById(r.assessedBy):null);I([I(i),I(a)]).subscribe(([r,f])=>{e.forEach((C,Be)=>{let x=r[Be];x&&(C.propertyLocation=x.location,C.taxDeclarationNo=Number(x.taxDeclarationNo),C.titleNo=Number(x.titleNo),C.classification=x.classification,C.landArea=x.landArea)}),this.dataSource=new he(e),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})})}applyFilter(e){let i=e.target.value;this.dataSource.filter=i.trim().toLocaleLowerCase()}openDialog(e){this.dialog.open(B,{data:e||{}}).afterClosed().subscribe(a=>{a&&(a.id?this.assessmentService.updateAssessment(a).subscribe(()=>{this.loadAssessment()}):this.assessmentService.createAssessment(a).subscribe(()=>{this.loadAssessment()}))})}deleteAssessment(e){confirm("Are you sure you want to delete this Assessment?")&&this.assessmentService.deleteAssessment(e).subscribe(()=>{this.loadAssessment()})}static \u0275fac=function(i){return new(i||t)(h(Ue),h(Te),h($),h(U))};static \u0275cmp=b({type:t,selectors:[["app-assessments"]],viewQuery:function(i,a){if(i&1&&(D(j,5),D(we,5),D(R,5),D(et,5,q)),i&2){let r;w(r=M())&&(a.paginator=r.first),w(r=M())&&(a.sort=r.first),w(r=M())&&(a.table=r.first),w(r=M())&&(a.container=r.first)}},decls:57,vars:5,consts:[["input",""],[1,"table-container"],[1,"text-2xl","font-bold"],["mat-raised-button","","color","primary",3,"click"],[1,"full-width"],["matInput","","placeholder","Search assessment...",3,"keyup"],[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","propertyId"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","assessmentId"],["matColumnDef","propertyLocation"],["matColumnDef","taxDeclarationNo"],["matColumnDef","titleNo"],["matColumnDef","classification"],["matColumnDef","location"],["matColumnDef","landArea"],["matColumnDef","assessedValue"],["matColumnDef","marketValue"],["matColumnDef","assessmentLevel"],["matColumnDef","assessedBy"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","space-x-2",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of users",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-cell","",1,"space-x-2"],["mat-icon-button","","color","primary","matTooltip","Edit Master Code",3,"click"],["mat-icon-button","","color","primary","matTooltip","Delete Master Code",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(i,a){if(i&1){let r=A();o(0,"div",1)(1,"div")(2,"h1",2),s(3,"Field Appraisal & Assessment Sheet(FAAS)"),n(),o(4,"button",3),v("click",function(){return S(r),g(a.openDialog())}),s(5,"Add FAAS"),n()(),o(6,"div")(7,"mat-form-field",4)(8,"mat-label"),s(9,"Filter"),n(),o(10,"input",5,0),v("keyup",function(C){return S(r),g(a.applyFilter(C))}),n()()(),o(12,"div",6)(13,"table",7),u(14,8),m(15,it,2,0,"th",9)(16,nt,2,1,"td",10),_(),u(17,11),m(18,ot,2,0,"th",9)(19,at,2,1,"td",10),_(),u(20,12),m(21,st,2,0,"th",9)(22,rt,2,1,"td",10),_(),u(23,13),m(24,lt,2,0,"th",9)(25,mt,2,1,"td",10),_(),u(26,14),m(27,pt,2,0,"th",9)(28,ct,2,1,"td",10),_(),u(29,15),m(30,dt,2,0,"th",9)(31,ft,2,1,"td",10),_(),u(32,16),m(33,ut,2,0,"th",9)(34,_t,2,1,"td",10),_(),u(35,17),m(36,Ct,2,0,"th",9)(37,St,2,1,"td",10),_(),u(38,18),m(39,gt,2,0,"th",9)(40,ht,2,1,"td",10),_(),u(41,19),m(42,vt,2,0,"th",9)(43,yt,2,1,"td",10),_(),u(44,20),m(45,xt,2,0,"th",9)(46,At,2,1,"td",10),_(),u(47,21),m(48,Dt,2,0,"th",9)(49,wt,2,1,"td",10),_(),u(50,22),m(51,Mt,2,0,"th",23)(52,Et,7,0,"td",24),_(),m(53,It,1,0,"tr",25)(54,bt,1,0,"tr",26)(55,Tt,3,1,"tr",27),n(),d(56,"mat-paginator",28),n()()}i&2&&(l(13),p("dataSource",a.dataSource),l(40),p("matHeaderRowDef",a.displayedColumns),l(),p("matRowDefColumns",a.displayedColumns),l(2),p("pageSizeOptions",G(4,tt)))},dependencies:[V,F,k,N,ge,R,me,fe,pe,le,ue,ce,de,_e,Ce,Se,Ee,Me,j,P,O,se,De,Ae,T,L,ye],styles:[".table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:300px}  .mat-header-cell{background-color:#3f51b5;color:#fff;font-weight:700;font-size:16px;text-align:center}  .mat-header-row{height:56px}.full-width[_ngcontent-%COMP%]{width:100%}"]})};export{$e as AssessmentsComponent};
