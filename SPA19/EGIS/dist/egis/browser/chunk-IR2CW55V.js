import"./chunk-F5X5MWHG.js";import"./chunk-MS4AQ6UA.js";import{a as yt,b as St,c as R,e as gt,f as ht,g as wt,h as Mt}from"./chunk-4QXU7Q3Z.js";import{G as ft,I as Ct,J as _t,e as b,f as X,g as Z,h as tt,i as et,j as nt,k as it,l as ot,m as at,n as lt,o as rt,p as mt,q as ct,r as pt,s as ut,t as dt,u as st}from"./chunk-MYHFZ2D2.js";import"./chunk-3RK6DDJD.js";import{$ as z,g as Q,ga as W,k as L,la as q,ma as J,pa as U,r as $,ra as G,sa as K}from"./chunk-KTJ4FNCK.js";import{c as j}from"./chunk-XHFMZJAH.js";import{a as N}from"./chunk-IKLMD3RG.js";import{m as Y,t as k}from"./chunk-T6TR6RQX.js";import{$ as V,$b as F,Bb as o,Cb as a,Db as d,Eb as s,Fb as f,Hb as E,Lb as w,Mb as S,Qb as M,Rb as x,Sb as v,Va as r,Vb as A,W as B,Wb as l,Xb as g,Yb as C,_a as D,_b as I,ac as O,dc as H,fb as P,ia as _,ja as y,lb as c,sb as p}from"./chunk-5MRHDFKX.js";var T=class t{constructor(n){this.http=n}apibaseurl=Mt.toimsApiBaseURL;getCollectionByMonthYear(n,e){let i={month:n,year:e};return this.http.get(this.apibaseurl+"/Collectionsummary/getViews/",{params:i})}static \u0275fac=function(e){return new(e||t)(V(N))};static \u0275prov=B({token:t,factory:t.\u0275fac,providedIn:"root"})};var Tt=()=>[5,10,25,100];function Dt(t,n){if(t&1&&(o(0,"mat-option",31),l(1),a()),t&2){let e=n.$implicit;p("value",e.value),r(),C(" ",e.name," ")}}function Et(t,n){if(t&1&&(o(0,"mat-option",31),l(1),a()),t&2){let e=n.$implicit;p("value",e),r(),C(" ",e," ")}}function It(t,n){t&1&&(o(0,"th",32),l(1,"Code"),a())}function Ft(t,n){if(t&1&&(o(0,"td",33),l(1),a()),t&2){let e=n.$implicit;r(),g(e.code)}}function Ot(t,n){t&1&&d(0,"td",34)}function Rt(t,n){t&1&&(o(0,"th",35),l(1,"Description"),a())}function Bt(t,n){if(t&1&&(o(0,"td",33),l(1),a()),t&2){let e=n.$implicit;r(),g(e.description)}}function Vt(t,n){t&1&&d(0,"td",34)}function Pt(t,n){t&1&&(o(0,"th",35),l(1,"Beginning Bal."),a())}function At(t,n){if(t&1&&(o(0,"td",36),l(1),a()),t&2){let e=n.$implicit;r(),g(e.beginningBalance)}}function Ht(t,n){if(t&1&&(o(0,"td",37)(1,"b"),l(2),a()()),t&2){let e=S();r(2),C("Total: ",e.totalBeginningBalance,"")}}function Yt(t,n){t&1&&(o(0,"th",35),l(1,"Amount"),a())}function kt(t,n){if(t&1&&(o(0,"td",36),l(1),a()),t&2){let e=n.$implicit;r(),g(e.amount)}}function Nt(t,n){if(t&1&&(o(0,"td",37)(1,"b"),l(2),a()()),t&2){let e=S();r(2),C("Total: ",e.totalAmount,"")}}function jt(t,n){t&1&&(o(0,"th",35),l(1,"Actual"),a())}function Qt(t,n){if(t&1&&(o(0,"td",36),l(1),a()),t&2){let e=n.$implicit;r(),g(e.actual)}}function Lt(t,n){if(t&1&&(o(0,"td",37)(1,"b"),l(2),a()()),t&2){let e=S();r(2),C("Total: ",e.totalActual,"")}}function $t(t,n){t&1&&(o(0,"th",35),l(1," Action "),a())}function zt(t,n){if(t&1){let e=E();o(0,"td",38)(1,"button",39),w("click",function(){let m=_(e).$implicit,h=S();return y(h.openDetails(m.code,m.month,m.year))}),o(2,"mat-icon"),l(3,"open_in_new"),a()()()}}function Wt(t,n){t&1&&d(0,"td",34)}function qt(t,n){t&1&&d(0,"tr",40)}function Jt(t,n){t&1&&d(0,"tr",41)}function Ut(t,n){t&1&&d(0,"tr",42)}function Gt(t,n){if(t&1&&(o(0,"tr",43)(1,"td",44),l(2),a()()),t&2){S();let e=A(23);r(2),C('No data matching the filter "',e.value,'"')}}var xt=class t{constructor(n,e){this.router=n;this.collectionsummaryService=e}showCS=!1;selectedCode;selectedMonth=new Date().getMonth()+1;selectedYear=new Date().getFullYear();years=[];months=[{name:"January",value:1},{name:"February",value:2},{name:"March",value:3},{name:"April",value:4},{name:"May",value:5},{name:"June",value:6},{name:"July",value:7},{name:"August",value:8},{name:"September",value:9},{name:"October",value:10},{name:"November",value:11},{name:"December",value:12}];totalBeginningBalance=0;totalAmount=0;totalActual=0;displayedColumns=["code","description","beginningBalance","amount","actual","actions"];dataSource;paginator;sort;table;ngOnInit(){let n=new Date().getFullYear();for(let e=n;e>=2e3;e--)this.years.push(e);this.loadCollectionSummaries()}loadCollectionSummaries(){this.collectionsummaryService.getCollectionByMonthYear(this.selectedMonth,this.selectedYear).subscribe(n=>{this.dataSource=new st(n),this.calculateTotals(n),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}calculateTotals(n){this.totalBeginningBalance=n.reduce((e,i)=>e+(i.beginningBalance||0),0),this.totalAmount=n.reduce((e,i)=>e+(i.amount||0),0),this.totalActual=n.reduce((e,i)=>e+(i.actual||0),0)}applyFilter(n){let e=n.target.value;this.dataSource.filter=e.trim().toLocaleLowerCase()}openDetails(n,e,i){console.log(`Navigating to details for code: ${n}, month: ${e}, year: ${i}`),this.router.navigate(["/mainlayout/collectionsummarydetails",n,e,i]),this.selectedCode=n,this.selectedMonth=Number(e),this.selectedYear=i,this.showCS=!0}static \u0275fac=function(e){return new(e||t)(D(j),D(T))};static \u0275cmp=P({type:t,selectors:[["app-collection-summary"]],viewQuery:function(e,i){if(e&1&&(M(R,5),M(gt,5),M(b,5)),e&2){let m;x(m=v())&&(i.paginator=m.first),x(m=v())&&(i.sort=m.first),x(m=v())&&(i.table=m.first)}},decls:56,vars:10,consts:[["input",""],[1,"table-container"],[1,"text-2xl","font-bold"],[1,"month-year-row"],["appearance","fill",1,"month-dropdown"],[3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill",1,"year-dropdown"],["mat-raised-button","","color","primary",1,"view-btn",3,"click"],[1,"full-width"],["matInput","","placeholder","Search Collection..",3,"keyup"],[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","code"],["mat-header-cell","","style","width: 100px;",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","description"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","beginningBalance"],["mat-cell","","align","right",4,"matCellDef"],["mat-footer-cell","","align","right",4,"matFooterCellDef"],["matColumnDef","amount"],["matColumnDef","actual"],["matColumnDef","actions"],["mat-cell","","class","space-x-2",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of users",3,"pageSizeOptions"],[3,"value"],["mat-header-cell","",2,"width","100px"],["mat-cell",""],["mat-footer-cell",""],["mat-header-cell",""],["mat-cell","","align","right"],["mat-footer-cell","","align","right"],["mat-cell","",1,"space-x-2"],["mat-icon-button","","color","primary","matTooltip","Open details",3,"click"],["mat-header-row",""],["mat-row",""],["mat-footer-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(e,i){if(e&1){let m=E();o(0,"div",1)(1,"div")(2,"h1",2),l(3,"Collection Summary"),a()(),l(4," \xA0 "),o(5,"div",3)(6,"mat-form-field",4)(7,"mat-label"),l(8,"Month"),a(),o(9,"mat-select",5),O("ngModelChange",function(u){return _(m),F(i.selectedMonth,u)||(i.selectedMonth=u),y(u)}),c(10,Dt,2,2,"mat-option",6),a()(),o(11,"mat-form-field",7)(12,"mat-label"),l(13,"Year"),a(),o(14,"mat-select",5),O("ngModelChange",function(u){return _(m),F(i.selectedYear,u)||(i.selectedYear=u),y(u)}),c(15,Et,2,2,"mat-option",6),a()(),o(16,"button",8),w("click",function(){return _(m),y(i.loadCollectionSummaries())}),l(17,"View"),a()(),o(18,"div")(19,"mat-form-field",9)(20,"mat-label"),l(21,"Filter"),a(),o(22,"input",10,0),w("keyup",function(u){return _(m),y(i.applyFilter(u))}),a()()(),l(24," \xA0 "),o(25,"div",11)(26,"table",12),s(27,13),c(28,It,2,0,"th",14)(29,Ft,2,1,"td",15)(30,Ot,1,0,"td",16),f(),s(31,17),c(32,Rt,2,0,"th",18)(33,Bt,2,1,"td",15)(34,Vt,1,0,"td",16),f(),s(35,19),c(36,Pt,2,0,"th",18)(37,At,2,1,"td",20)(38,Ht,3,1,"td",21),f(),s(39,22),c(40,Yt,2,0,"th",18)(41,kt,2,1,"td",20)(42,Nt,3,1,"td",21),f(),s(43,23),c(44,jt,2,0,"th",18)(45,Qt,2,1,"td",20)(46,Lt,3,1,"td",21),f(),s(47,24),c(48,$t,2,0,"th",18)(49,zt,4,0,"td",25)(50,Wt,1,0,"td",16),f(),c(51,qt,1,0,"tr",26)(52,Jt,1,0,"tr",27)(53,Ut,1,0,"tr",28)(54,Gt,3,1,"tr",29),a(),d(55,"mat-paginator",30),a()()}e&2&&(r(9),I("ngModel",i.selectedMonth),r(),p("ngForOf",i.months),r(4),I("ngModel",i.selectedYear),r(),p("ngForOf",i.years),r(11),p("dataSource",i.dataSource),r(25),p("matHeaderRowDef",i.displayedColumns),r(),p("matRowDefColumns",i.displayedColumns),r(),p("matFooterRowDef",i.displayedColumns),r(2),p("pageSizeOptions",H(9,Tt)))},dependencies:[W,J,q,z,dt,b,Z,at,et,X,rt,tt,lt,nt,ot,it,mt,pt,ct,ut,wt,ht,R,K,G,U,St,yt,_t,Ct,ft,k,Y,$,Q,L],styles:[".table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:300px}  .mat-header-cell{background-color:#3f51b5;color:#fff;font-weight:700;font-size:16px;text-align:center}  .mat-header-row{height:56px}.full-width[_ngcontent-%COMP%]{width:100%}.button-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.button-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:8px}.month-year-row[_ngcontent-%COMP%]{display:flex;align-items:bottom;gap:16px;margin-bottom:16px}.month-dropdown[_ngcontent-%COMP%], .year-dropdown[_ngcontent-%COMP%]{min-width:150px}.process-btn[_ngcontent-%COMP%]{height:56px;min-width:150px;margin-top:0;margin-left:8px;display:flex;align-items:center;justify-content:center;box-sizing:border-box;font-size:16px}"]})};export{xt as CollectionSummaryComponent};
