import{a as R}from"./chunk-W3L6UWDE.js";import{a as L}from"./chunk-UQZSQSYL.js";import{a as Re}from"./chunk-UGIGXN45.js";import"./chunk-F5X5MWHG.js";import{a as Oe,b as Pe,c as $,e as Le}from"./chunk-2IGJZFV7.js";import{a as ge,b as Se,c as xe,e as ve,h as ye}from"./chunk-KGOMAVQY.js";import{a as P,b as Ae,c as De,e as we,f as be,h as Me,i as Ee,k as Ie,l as Ne,n as Te,o as Ve,p as ke,q as Fe}from"./chunk-NFABPVPM.js";import{a as me,b as pe,c as ce,h as de}from"./chunk-3KDABX7K.js";import{c as _e,d as Ce}from"./chunk-RC2IBETA.js";import"./chunk-SYAC655V.js";import"./chunk-ECBSDO4K.js";import{a as re,b as le}from"./chunk-DQWGBFJK.js";import"./chunk-MS4AQ6UA.js";import{a as he,b as O}from"./chunk-LB6LRJVS.js";import{f as fe,i as ue}from"./chunk-YBNMVR6Q.js";import{a as ne,b as I,c as N}from"./chunk-AWMIQM5V.js";import"./chunk-O27SARHL.js";import"./chunk-3RK6DDJD.js";import{c as oe}from"./chunk-BUEFDGFJ.js";import"./chunk-SGYCFQGT.js";import"./chunk-HSUA2CKH.js";import"./chunk-TMATL23G.js";import{b as Y,g as J,h as K,ha as T,la as ae,m as W,oa as V,p as X,pa as se,q as Z,s as ee,ta as k,ua as F,v as te,x as ie}from"./chunk-FPYKYBTQ.js";import{Db as a,Eb as n,Fb as f,Gb as u,Hb as _,Jb as y,Jc as G,Kc as z,Lb as x,Mb as v,Qb as A,Rb as D,Rc as E,Sb as w,Vb as b,Wb as s,Xb as Q,Ya as l,Yb as c,bb as S,cc as q,db as j,dc as H,ib as M,ka as h,la as g,nb as m,ub as p,w as B}from"./chunk-NKHI3LCY.js";function ze(t,e){if(t&1&&(a(0,"mat-option",26),s(1),n()),t&2){let i=e.$implicit;p("value",i.id),l(),c(" ",i.userName," ")}}function Ye(t,e){if(t&1&&(a(0,"mat-option",26),s(1),n()),t&2){let i=e.$implicit;p("value",i.propertyId),l(),c(" ",i.taxDeclarationNo," ")}}function Je(t,e){if(t&1){let i=y();a(0,"mat-form-field",6)(1,"mat-label"),s(2,"Select Tax Declaration No"),n(),a(3,"mat-select",27),x("selectionChange",function(r){h(i);let d=v();return g(d.onSelectedTax(r.value))}),m(4,Ye,2,2,"mat-option",8),n()()}if(t&2){let i=v();l(4),p("ngForOf",i.ownerProperties)}}function Ke(t,e){if(t&1&&(a(0,"mat-option",26),s(1),n()),t&2){let i=e.$implicit;p("value",i.id),l(),c(" ",i.userName," ")}}var U=class t{constructor(e,i,o,r,d){this.fb=e;this.dialogRef=i;this.data=o;this.usersService=r;this.propertyService=d;this.isEditMode=!!o.propertyId,this.form=this.fb.group({userId:[null],userName:[null],propertyId:[null],propertyLocation:[o.propertyLocation],taxDeclarationNo:[o.taxDeclarationNo],titleNo:[o.titleNo],classification:[o.classification],location:[o.location],landArea:[o.landArea],assessedValue:[o.assessedValue],marketValue:[o.marketValue],assessmentLevel:[o.assessmentLevel],assessmentDate:[o.assessmentDate?new Date(o.assessmentDate):""],validUntil:[o.validUntil?new Date(o.validUntil):null],assessedBy:[null]}),this.loadOwner(),this.loadAssessor()}form;isEditMode;selectedCode;selectedProperty=null;usersOwner=[];usersAssessor=[];selectedOwner=null;selectedAssessor=null;ownerProperties=[];userOwner="Owner";userAssessor="Assessor";loadOwner(){this.usersService.getUserIDName(this.userOwner).subscribe(e=>{this.usersOwner=e})}loadAssessor(){this.usersService.getUserIDName(this.userAssessor).subscribe(e=>{this.usersAssessor=e})}onSelectedOwner(e){let i=this.usersOwner.find(o=>o.id===e);this.selectedOwner=i||null,this.form.patchValue({ownerId:e}),this.propertyService.getAllProperties().subscribe(o=>{this.ownerProperties=o.filter(r=>r.ownerId===e),this.form.patchValue({propertyId:null,propertyLocation:"",taxDeclarationNo:"",titleNo:"",classification:"",location:"",landArea:""})})}onSelectedAssessor(e){let i=this.usersAssessor.find(o=>o.id===e);this.selectedAssessor=i||null,this.form.patchValue({assessedBy:e}),console.log("Selected Assessor:",this.selectedAssessor)}onSelectedTax(e){let i=this.ownerProperties.find(o=>o.propertyId===e);i&&this.form.patchValue({propertyId:i.propertyId,propertyLocation:i.location,taxDeclarationNo:i.taxDeclarationNo,titleNo:i.titleNo,classification:i.classification,location:i.location,landArea:i.landArea})}onSubmit(){if(this.form.valid){let e=this.form.value;if(e.assessmentDate instanceof Date){let i=e.assessmentDate.getFullYear(),o=String(e.assessmentDate.getMonth()+1).padStart(2,"0"),r=String(e.assessmentDate.getDate()).padStart(2,"0");e.assessmentDate=`${i}-${o}-${r}`}if(e.validUntil instanceof Date){let i=e.validUntil.getFullYear(),o=String(e.validUntil.getMonth()+1).padStart(2,"0"),r=String(e.validUntil.getDate()).padStart(2,"0");e.validUntil=`${i}-${o}-${r}`}this.dialogRef.close(e)}}onCancel(){this.dialogRef.close()}static \u0275fac=function(i){return new(i||t)(S(te),S(ge),S(Se),S(L),S(R))};static \u0275cmp=M({type:t,selectors:[["app-assessments-dialog"]],features:[q([Ce()])],decls:75,vars:11,consts:[["validpicker",""],["picker",""],[1,"container-fluid"],["mat-dialog-title",""],[1,"form-container",3,"ngSubmit","formGroup"],[1,"form-grid","three-columns"],[1,"full-width"],["formControlName","userId",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["class","full-width",4,"ngIf"],["matInput","","formControlName","propertyId","readonly",""],["matInput","","formControlName","propertyLocation","readonly",""],["matInput","","formControlName","taxDeclarationNo","readonly",""],["matInput","","formControlName","titleNo","readonly",""],["matInput","","formControlName","classification","readonly",""],["matInput","","formControlName","location","readonly",""],["matInput","","formControlName","landArea","readonly",""],["matInput","","formControlName","assessedValue","required",""],["matInput","","formControlName","marketValue","required",""],["matInput","","formControlName","assessmentLevel","required",""],["matInput","","formControlName","validUntil",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","formControlName","assessmentDate",3,"matDatepicker"],[1,"dialog-actions"],["mat-button","","type","button",3,"click"],["mat-raised-button","","type","submit",3,"disabled"],[3,"value"],["formControlName","propertyId",3,"selectionChange"]],template:function(i,o){if(i&1){let r=y();a(0,"div",2)(1,"h2",3),s(2),n(),a(3,"form",4),x("ngSubmit",function(){return h(r),g(o.onSubmit())}),a(4,"div",5)(5,"mat-form-field",6)(6,"mat-label"),s(7,"Select property owner"),n(),a(8,"mat-select",7),x("selectionChange",function(C){return h(r),g(o.onSelectedOwner(C.value))}),m(9,ze,2,2,"mat-option",8),n()(),m(10,Je,5,1,"mat-form-field",9),a(11,"mat-form-field",6)(12,"mat-label"),s(13,"Property ID"),n(),f(14,"input",10),n(),a(15,"mat-form-field",6)(16,"mat-label"),s(17,"Property Location"),n(),f(18,"input",11),n(),a(19,"mat-form-field",6)(20,"mat-label"),s(21,"Tax Declaration No"),n(),f(22,"input",12),n(),a(23,"mat-form-field",6)(24,"mat-label"),s(25,"Title No"),n(),f(26,"input",13),n(),a(27,"mat-form-field",6)(28,"mat-label"),s(29,"Classification"),n(),f(30,"input",14),n(),a(31,"mat-form-field",6)(32,"mat-label"),s(33,"Location"),n(),f(34,"input",15),n(),a(35,"mat-form-field",6)(36,"mat-label"),s(37,"Land Area"),n(),f(38,"input",16),n(),a(39,"mat-form-field",6)(40,"mat-label"),s(41,"Assessed Value"),n(),f(42,"input",17),n(),a(43,"mat-form-field",6)(44,"mat-label"),s(45,"Market Value"),n(),f(46,"input",18),n(),a(47,"mat-form-field",6)(48,"mat-label"),s(49,"Assessment Level"),n(),f(50,"input",19),n(),a(51,"mat-form-field",6)(52,"mat-label"),s(53,"Select assessor"),n(),a(54,"mat-select",7),x("selectionChange",function(C){return h(r),g(o.onSelectedAssessor(C.value))}),m(55,Ke,2,2,"mat-option",8),n()(),a(56,"mat-form-field",6)(57,"mat-label"),s(58,"Valid Until"),n(),f(59,"input",20)(60,"mat-datepicker-toggle",21)(61,"mat-datepicker",null,0),n(),a(63,"mat-form-field",6)(64,"mat-label"),s(65,"Assessment Date"),n(),f(66,"input",22)(67,"mat-datepicker-toggle",21)(68,"mat-datepicker",null,1),n()(),a(70,"div",23)(71,"button",24),x("click",function(){return h(r),g(o.onCancel())}),s(72,"Cancel"),n(),a(73,"button",25),s(74),n()()()()}if(i&2){let r=b(62),d=b(69);l(2),c("",o.isEditMode?"Edit":"Add"," Assessment"),l(),p("formGroup",o.form),l(6),p("ngForOf",o.usersOwner),l(),p("ngIf",o.ownerProperties.length>0),l(45),p("ngForOf",o.usersAssessor),l(4),p("matDatepicker",r),l(),p("for",r),l(6),p("matDatepicker",d),l(),p("for",d),l(6),p("disabled",!o.form.valid),l(),Q(o.isEditMode?"Update":"Create")}},dependencies:[ie,W,Y,J,K,ee,X,Z,se,V,T,ae,E,G,z,F,k,oe,O,he,fe,N,I,ye,ve,_e,de,me,pe,ce],styles:[".form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;align-items:center;justify-content:center;height:100%;padding:10px}.full-width[_ngcontent-%COMP%]{width:100%}mat-dialog-content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:200px}  .mat-dialog-container{width:2000px!important;max-width:2000px!important;min-width:1500px!important;padding:40px 32px 32px!important;border-radius:24px!important;box-shadow:0 8px 32px #0000002e,0 1.5px 6px #0000001a!important;background:#f8f8fc!important;display:block!important}mat-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:18px;padding:0;box-sizing:border-box;background:#e7eaf3;border-radius:12px;transition:box-shadow .2s;box-shadow:0 2px 8px #2c3e5012}.mat-form-field-label[_ngcontent-%COMP%]{white-space:normal!important;font-size:1em;line-height:1.3;overflow-wrap:break-word;width:100%;text-align:left;color:#2d3559;font-weight:500}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;gap:24px 20px;margin-bottom:16px}.dialog-actions[_ngcontent-%COMP%]{margin-top:24px;display:flex;justify-content:flex-end;gap:12px}"],changeDetection:0})};var We=["dynamicComponentContainer"],Xe=()=>[5,10,25,100];function Ze(t,e){t&1&&(a(0,"th",29),s(1," ID "),n())}function et(t,e){if(t&1&&(a(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.propertyId," ")}}function tt(t,e){t&1&&(a(0,"th",29),s(1," Assessment ID "),n())}function it(t,e){if(t&1&&(a(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.assessmentId," ")}}function nt(t,e){t&1&&(a(0,"th",29),s(1," Property Location "),n())}function ot(t,e){if(t&1&&(a(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.propertyLocation," ")}}function at(t,e){t&1&&(a(0,"th",29),s(1," Tax Declaration No "),n())}function st(t,e){if(t&1&&(a(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.taxDeclarationNo," ")}}function rt(t,e){t&1&&(a(0,"th",29),s(1," Title No "),n())}function lt(t,e){if(t&1&&(a(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.titleNo," ")}}function mt(t,e){t&1&&(a(0,"th",29),s(1," Classification "),n())}function pt(t,e){if(t&1&&(a(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.classification," ")}}function ct(t,e){t&1&&(a(0,"th",29),s(1," Location "),n())}function dt(t,e){if(t&1&&(a(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.location," ")}}function ft(t,e){t&1&&(a(0,"th",29),s(1," Land Area "),n())}function ut(t,e){if(t&1&&(a(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.landArea," ")}}function _t(t,e){t&1&&(a(0,"th",29),s(1," Assessed Value "),n())}function Ct(t,e){if(t&1&&(a(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.assessedValue," ")}}function ht(t,e){t&1&&(a(0,"th",29),s(1," Market Value "),n())}function gt(t,e){if(t&1&&(a(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.marketValue," ")}}function St(t,e){t&1&&(a(0,"th",29),s(1," Assessment Level "),n())}function xt(t,e){if(t&1&&(a(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.assessmentLevel," ")}}function vt(t,e){t&1&&(a(0,"th",29),s(1," Assessed By "),n())}function yt(t,e){if(t&1&&(a(0,"td",30),s(1),n()),t&2){let i=e.$implicit;l(),c(" ",i.assessedByUserName," ")}}function At(t,e){t&1&&(a(0,"th",31),s(1," Action "),n())}function Dt(t,e){if(t&1){let i=y();a(0,"td",32)(1,"button",33),x("click",function(){let r=h(i).$implicit,d=v();return g(d.openDialog(r))}),a(2,"mat-icon"),s(3,"edit"),n()(),a(4,"button",34),x("click",function(){let r=h(i).$implicit,d=v();return g(d.deleteAssessment(r.id))}),a(5,"mat-icon"),s(6,"delete"),n()()()}}function wt(t,e){t&1&&f(0,"tr",35)}function bt(t,e){t&1&&f(0,"tr",36)}function Mt(t,e){if(t&1&&(a(0,"tr",37)(1,"td",38),s(2),n()()),t&2){v();let i=b(11);l(2),c('No data matching the filter "',i.value,'"')}}var Ue=class t{constructor(e,i,o,r){this.assessmentService=e;this.dialog=i;this.propertyService=o;this.usersService=r}showSubCode=!1;usersMap={};displayedColumns=["propertyLocation","taxDeclarationNo","titleNo","classification","landArea","assessedValue","marketValue","assessmentLevel","assessedBy","actions"];dataSource;paginator;sort;table;container;ngOnInit(){this.usersService.getAllUsers().subscribe(e=>{e.forEach(i=>this.usersMap[i.userId]=i.userName),this.loadAssessment()})}loadAssessment(){this.assessmentService.getAllAssessment().subscribe(e=>{let i=e.map(o=>this.propertyService.getPropertyById(o.propertyId));B(i).subscribe(o=>{e.forEach((r,d)=>{let C=o[d];C&&(r.propertyLocation=C.location,r.taxDeclarationNo=Number(C.taxDeclarationNo),r.titleNo=Number(C.titleNo),r.classification=C.classification,r.landArea=C.landArea),r.assessedByUserName=this.usersMap[r.assessedBy]||"N/A"}),this.dataSource=new Fe(e),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})})}applyFilter(e){let i=e.target.value;this.dataSource.filter=i.trim().toLocaleLowerCase()}openDialog(e){this.dialog.open(U,{data:e||{}}).afterClosed().subscribe(o=>{o&&(o.id?this.assessmentService.updateAssessment(o).subscribe(()=>{this.loadAssessment()}):this.assessmentService.createAssessment(o).subscribe(()=>{this.loadAssessment()}))})}deleteAssessment(e){confirm("Are you sure you want to delete this Assessment?")&&this.assessmentService.deleteAssessment(e).subscribe(()=>{this.loadAssessment()})}static \u0275fac=function(i){return new(i||t)(S(Re),S(xe),S(R),S(L))};static \u0275cmp=M({type:t,selectors:[["app-assessments"]],viewQuery:function(i,o){if(i&1&&(A($,5),A(Le,5),A(P,5),A(We,5,j)),i&2){let r;D(r=w())&&(o.paginator=r.first),D(r=w())&&(o.sort=r.first),D(r=w())&&(o.table=r.first),D(r=w())&&(o.container=r.first)}},decls:57,vars:5,consts:[["input",""],[1,"table-container"],[1,"text-2xl","font-bold"],["mat-raised-button","","color","primary",3,"click"],[1,"full-width"],["matInput","","placeholder","Search assessment...",3,"keyup"],[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","propertyId"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","assessmentId"],["matColumnDef","propertyLocation"],["matColumnDef","taxDeclarationNo"],["matColumnDef","titleNo"],["matColumnDef","classification"],["matColumnDef","location"],["matColumnDef","landArea"],["matColumnDef","assessedValue"],["matColumnDef","marketValue"],["matColumnDef","assessmentLevel"],["matColumnDef","assessedBy"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","space-x-2",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of users",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-cell","",1,"space-x-2"],["mat-icon-button","","color","primary","matTooltip","Edit Master Code",3,"click"],["mat-icon-button","","color","primary","matTooltip","Delete Master Code",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(i,o){if(i&1){let r=y();a(0,"div",1)(1,"div")(2,"h1",2),s(3,"Field Appraisal & Assessment Sheet(FAAS)"),n(),a(4,"button",3),x("click",function(){return h(r),g(o.openDialog())}),s(5,"Add FAAS"),n()(),a(6,"div")(7,"mat-form-field",4)(8,"mat-label"),s(9,"Filter"),n(),a(10,"input",5,0),x("keyup",function(C){return h(r),g(o.applyFilter(C))}),n()()(),a(12,"div",6)(13,"table",7),u(14,8),m(15,Ze,2,0,"th",9)(16,et,2,1,"td",10),_(),u(17,11),m(18,tt,2,0,"th",9)(19,it,2,1,"td",10),_(),u(20,12),m(21,nt,2,0,"th",9)(22,ot,2,1,"td",10),_(),u(23,13),m(24,at,2,0,"th",9)(25,st,2,1,"td",10),_(),u(26,14),m(27,rt,2,0,"th",9)(28,lt,2,1,"td",10),_(),u(29,15),m(30,mt,2,0,"th",9)(31,pt,2,1,"td",10),_(),u(32,16),m(33,ct,2,0,"th",9)(34,dt,2,1,"td",10),_(),u(35,17),m(36,ft,2,0,"th",9)(37,ut,2,1,"td",10),_(),u(38,18),m(39,_t,2,0,"th",9)(40,Ct,2,1,"td",10),_(),u(41,19),m(42,ht,2,0,"th",9)(43,gt,2,1,"td",10),_(),u(44,20),m(45,St,2,0,"th",9)(46,xt,2,1,"td",10),_(),u(47,21),m(48,vt,2,0,"th",9)(49,yt,2,1,"td",10),_(),u(50,22),m(51,At,2,0,"th",23)(52,Dt,7,0,"td",24),_(),m(53,wt,1,0,"tr",25)(54,bt,1,0,"tr",26)(55,Mt,3,1,"tr",27),n(),f(56,"mat-paginator",28),n()()}i&2&&(l(13),p("dataSource",o.dataSource),l(40),p("matHeaderRowDef",o.displayedColumns),l(),p("matRowDefColumns",o.displayedColumns),l(2),p("pageSizeOptions",H(4,Xe)))},dependencies:[V,F,k,T,ke,P,De,Ee,we,Ae,Ie,be,Me,Ne,Te,Ve,le,re,$,N,I,ne,Pe,Oe,E,O,ue],styles:[".table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:300px}  .mat-header-cell{background-color:#3f51b5;color:#fff;font-weight:700;font-size:16px;text-align:center}  .mat-header-row{height:56px}.full-width[_ngcontent-%COMP%]{width:100%}"]})};export{Ue as AssessmentsComponent};
