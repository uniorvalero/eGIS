import{a as F}from"./chunk-HGMN7EGA.js";import{a as Ut}from"./chunk-ZSWPU5YM.js";import"./chunk-F5X5MWHG.js";import{a as zt,b as Qt,c as $,e as Gt}from"./chunk-2IGJZFV7.js";import{a as wt,b as Tt,c as It,e as Et,h as Ot}from"./chunk-KGOMAVQY.js";import{a as N,b as kt,c as Bt,e as At,f as Rt,h as Nt,i as Ft,k as Lt,l as Vt,n as $t,o as jt,p as Ht,q as qt}from"./chunk-NFABPVPM.js";import{a as bt,b as Ct,c as Pt,h as ht}from"./chunk-3KDABX7K.js";import{c as vt,d as xt}from"./chunk-RC2IBETA.js";import"./chunk-SYAC655V.js";import"./chunk-ECBSDO4K.js";import{a as gt,b as _t}from"./chunk-DQWGBFJK.js";import"./chunk-MS4AQ6UA.js";import{a as Mt,b as Dt}from"./chunk-LB6LRJVS.js";import{f as St}from"./chunk-YBNMVR6Q.js";import{a as dt,b as E,c as O}from"./chunk-AWMIQM5V.js";import"./chunk-O27SARHL.js";import"./chunk-3RK6DDJD.js";import"./chunk-SGYCFQGT.js";import{a as yt}from"./chunk-HSUA2CKH.js";import{a as tt}from"./chunk-TMATL23G.js";import{b as et,g as it,h as nt,ha as k,ia as st,la as ft,m as at,n as ot,oa as B,p as rt,pa as ut,q as mt,s as lt,ta as A,ua as R,v as pt,x as ct}from"./chunk-FPYKYBTQ.js";import{Db as a,Eb as n,Fb as C,Gb as g,Hb as _,Jb as P,Jc as K,Kc as W,Lb as b,Mb as h,Nc as X,Qb as S,Qc as Z,Rb as v,Rc as I,Sb as x,Vb as T,Wb as r,Xb as Q,Y as H,Ya as m,Yb as d,a as j,ba as q,bb as f,cc as G,db as z,dc as U,gc as V,hc as Y,ib as w,ic as J,ka as u,la as y,nb as c,ub as p}from"./chunk-NKHI3LCY.js";function ie(e,t){if(e&1&&(a(0,"mat-option",19),r(1),n()),e&2){let i=t.$implicit;p("value",i),m(),d(" ",i," ")}}function ne(e,t){if(e&1&&(a(0,"mat-option",19),r(1),n()),e&2){let i=t.$implicit;p("value",i.name),m(),d(" ",i.name," ")}}function ae(e,t){e&1&&(a(0,"mat-error"),r(1,"Type of Payment is required"),n())}function oe(e,t){if(e&1&&(a(0,"mat-option",19),r(1),n()),e&2){let i=t.$implicit;p("value",i.name),m(),d(" ",i.name," ")}}function re(e,t){e&1&&(a(0,"mat-error"),r(1,"Status is required"),n())}var M=class e{constructor(t,i,o,l,s){this.fb=t;this.dialogRef=i;this.data=o;this.bpltasuserService=l;this.bpltasapplicationService=s;this.isEditMode=!!o.id,this.form=this.fb.group({applicationId:[o.applicationId||"",[]],receiptNo:[o.receiptNo||"",[]],amount:[o.amount||0],typesOfPayment:[o.typesOfPayment||""],paymentDate:[o.paymentDate],status:[o.status||""]}),this.loadApplicationIds()}form;isEditMode;paid="Paid";approved="Approved";pending="Pending";applicationIds=[];statusOptions=[{name:"Paid"},{name:"Pending"},{name:"Cancelled"}];paymentOptions=[{name:"GCash"},{name:"Online Bank Transfer"},{name:"Cash"},{name:"Check"},{name:"Credit Card"},{name:"Debit Card"},{name:"Mobile Payment"}];loadApplicationIds(){this.bpltasapplicationService.getApplicationIds(this.approved).subscribe(t=>{this.applicationIds=t})}onSubmit(){let t=j({},this.form.value);if(this.form.valid){if(t.paymentDate instanceof Date){let i=t.paymentDate.getFullYear(),o=String(t.paymentDate.getMonth()+1).padStart(2,"0"),l=String(t.paymentDate.getDate()).padStart(2,"0");t.paymentDate=`${i}-${o}-${l}`}this.dialogRef.close(t)}}onCancel(){this.dialogRef.close()}static \u0275fac=function(i){return new(i||e)(f(pt),f(wt),f(Tt),f(Ut),f(F))};static \u0275cmp=w({type:e,selectors:[["app-payment-dialog"]],features:[G([xt()])],decls:42,vars:11,consts:[["picker",""],[1,"container-fluid"],["mat-dialog-title",""],[1,"form-container",3,"ngSubmit","formGroup"],[1,"form-grid"],[1,"full-width"],["formControlName","applicationId"],[3,"value",4,"ngFor","ngForOf"],["formControlName","typesOfPayment","required",""],[4,"ngIf"],["appearance","fill",1,"form-field"],["matInput","","formControlName","amount","type","number"],["matInput","","formControlName","receiptNo","type","number"],["matInput","","formControlName","paymentDate",3,"matDatepicker"],["matSuffix","",3,"for"],["formControlName","status","required",""],[1,"dialog-actions"],["mat-button","","type","button",3,"click"],["mat-raised-button","","type","submit",3,"disabled"],[3,"value"]],template:function(i,o){if(i&1){let l=P();a(0,"div",1)(1,"h2",2),r(2),n(),a(3,"form",3),b("ngSubmit",function(){return u(l),y(o.onSubmit())}),a(4,"div",4)(5,"mat-form-field",5)(6,"mat-label"),r(7,"Select Application No.:"),n(),a(8,"mat-select",6),c(9,ie,2,2,"mat-option",7),n()(),a(10,"mat-form-field",5)(11,"mat-label"),r(12,"Type of Payment"),n(),a(13,"mat-select",8),c(14,ne,2,2,"mat-option",7),n(),c(15,ae,2,0,"mat-error",9),n(),a(16,"mat-form-field",10)(17,"mat-label"),r(18,"Amount"),n(),C(19,"input",11),n(),a(20,"mat-form-field",10)(21,"mat-label"),r(22,"Receipt No"),n(),C(23,"input",12),n(),a(24,"mat-form-field",5)(25,"mat-label"),r(26,"Date of Payment"),n(),C(27,"input",13)(28,"mat-datepicker-toggle",14)(29,"mat-datepicker",null,0),n(),a(31,"mat-form-field",5)(32,"mat-label"),r(33,"Status"),n(),a(34,"mat-select",15),c(35,oe,2,2,"mat-option",7),n(),c(36,re,2,0,"mat-error",9),n()(),a(37,"div",16)(38,"button",17),b("click",function(){return u(l),y(o.onCancel())}),r(39,"Cancel"),n(),a(40,"button",18),r(41),n()()()()}if(i&2){let l,s,D=T(30);m(2),d("",o.isEditMode?"Edit":"Add"," Payment"),m(),p("formGroup",o.form),m(6),p("ngForOf",o.applicationIds),m(5),p("ngForOf",o.paymentOptions),m(),p("ngIf",(l=o.form.get("typesOfPayment"))==null?null:l.hasError("required")),m(12),p("matDatepicker",D),m(),p("for",D),m(7),p("ngForOf",o.statusOptions),m(),p("ngIf",(s=o.form.get("status"))==null?null:s.hasError("required")),m(4),p("disabled",!o.form.valid),m(),Q(o.isEditMode?"Update":"Create")}},dependencies:[I,K,W,ct,at,et,ot,it,nt,lt,rt,mt,R,A,B,k,st,ft,ht,bt,Ct,Pt,ut,O,E,Ot,Et,vt,Dt,Mt,St],styles:[".form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;align-items:center;justify-content:center;height:100%;padding:10px;background:transparent!important;box-shadow:none!important}.full-width[_ngcontent-%COMP%]{width:100%}mat-dialog-content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:200px}mat-dialog-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}mat-form-field[_ngcontent-%COMP%]{width:100%;padding:10px}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:16px}.dialog-actions[_ngcontent-%COMP%]{margin-top:24px;display:flex;justify-content:flex-end;gap:12px}  .mat-dialog-container{background:#ffffff80!important;box-shadow:0 8px 32px #0000002e;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}  .mat-form-field-appearance-fill .mat-form-field-flex,   .mat-form-field-appearance-fill .mat-form-field-infix,   .mat-form-field-appearance-fill .mat-form-field-outline,   .mat-form-field-wrapper,   .mat-form-field-flex,   .mat-form-field-infix,   .mat-input-element,   .mat-select-trigger,   .mat-select-value,   .mat-select,   input.mat-input-element,   textarea.mat-input-element{background:transparent!important;box-shadow:none!important}"],changeDetection:0})};var L=class e{constructor(t){this.http=t}apibaseurl=yt.bpltasApiBaseURL;getPayment(){return this.http.get(this.apibaseurl+"/BPLTASPayment")}updatePayment(t){return this.http.put(`${this.apibaseurl+"/BPLTASPayment"}/${t.id}`,t)}createPayment(t){return t.id=0,console.log("Creating payment with data:",t),this.http.post(this.apibaseurl+"/BPLTASPayment/Create",t)}deletePayment(t){return this.http.delete(`${this.apibaseurl+"/BPLTASPayment"}/${t}`)}static \u0275fac=function(i){return new(i||e)(q(tt))};static \u0275prov=H({token:e,factory:e.\u0275fac,providedIn:"root"})};var le=["dynamicComponentContainer"],pe=()=>[5,10,25,100];function ce(e,t){e&1&&(a(0,"th",24),r(1," ID "),n())}function de(e,t){if(e&1&&(a(0,"td",25),r(1),n()),e&2){let i=t.$implicit;m(),d(" ",i.id," ")}}function se(e,t){e&1&&(a(0,"th",24),r(1," Application ID "),n())}function fe(e,t){if(e&1&&(a(0,"td",25),r(1),n()),e&2){let i=t.$implicit;m(),d(" ",i.applicationId," ")}}function ue(e,t){e&1&&(a(0,"th",24),r(1," Type of Payment "),n())}function ye(e,t){if(e&1&&(a(0,"td",25),r(1),n()),e&2){let i=t.$implicit;m(),d(" ",i.typeOfPayment," ")}}function ge(e,t){e&1&&(a(0,"th",24),r(1," Amount "),n())}function _e(e,t){if(e&1&&(a(0,"td",25),r(1),V(2,"currency"),n()),e&2){let i=t.$implicit;m(),d(" ",Y(2,1,i.amount)," ")}}function be(e,t){e&1&&(a(0,"th",24),r(1," Receipt No "),n())}function Ce(e,t){if(e&1&&(a(0,"td",25),r(1),n()),e&2){let i=t.$implicit;m(),d(" ",i.receiptNo," ")}}function Pe(e,t){e&1&&(a(0,"th",24),r(1," Date of Payment "),n())}function he(e,t){if(e&1&&(a(0,"td",25),r(1),V(2,"date"),n()),e&2){let i=t.$implicit;m(),d(" ",J(2,1,i.paymentDate,"shortDate")," ")}}function Se(e,t){e&1&&(a(0,"th",24),r(1," Status "),n())}function ve(e,t){if(e&1&&(a(0,"td",25),r(1),n()),e&2){let i=t.$implicit;m(),d(" ",i.status," ")}}function xe(e,t){e&1&&(a(0,"th",26),r(1," Action "),n())}function Me(e,t){if(e&1){let i=P();a(0,"td",27)(1,"button",28),b("click",function(){let l=u(i).$implicit,s=h();return y(s.paymentLedgers(l.id))}),a(2,"mat-icon"),r(3,"visibility"),n()(),a(4,"button",29),b("click",function(){let l=u(i).$implicit,s=h();return y(s.openDialog(l))}),a(5,"mat-icon"),r(6,"edit"),n()(),a(7,"button",30),b("click",function(){let l=u(i).$implicit,s=h();return y(s.deletePayment(l.id))}),a(8,"mat-icon"),r(9,"delete"),n()()()}}function De(e,t){e&1&&C(0,"tr",31)}function we(e,t){e&1&&C(0,"tr",32)}function Te(e,t){if(e&1&&(a(0,"tr",33)(1,"td",34),r(2),n()()),e&2){h();let i=T(13);m(2),d('No data matching the filter "',i.value,'"')}}var Jt=class e{constructor(t,i,o){this.bpltaspaymentService=t;this.dialog=i;this.bpltasapplicationService=o}showSubCode=!1;selectedMasterCode;selectedDescription;displayedColumns=["applicationId","receiptNo","typeOfPayment","amount","status","paymentDate","actions"];dataSource;paginator;sort;table;container;ngOnInit(){this.loadPayment()}paymentLedgers(t){this.dialog.open(M,{data:t||{}}).afterClosed().subscribe(o=>{o&&this.bpltaspaymentService.updatePayment(o).subscribe(()=>{this.loadPayment()})})}loadPayment(){this.bpltaspaymentService.getPayment().subscribe(t=>{this.dataSource=new qt(t),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}applyFilter(t){let i=t.target.value;this.dataSource.filter=i.trim().toLocaleLowerCase()}openDialog(t){this.dialog.open(M,{data:t||{}}).afterClosed().subscribe(o=>{o&&(o.id?this.bpltaspaymentService.updatePayment(o).subscribe(()=>{this.loadPayment()}):this.bpltaspaymentService.createPayment(o).subscribe(()=>{this.loadPayment()}))})}deletePayment(t){confirm("Are you sure you want to delete this payment?")&&this.bpltaspaymentService.deletePayment(t).subscribe(()=>{this.loadPayment()})}static \u0275fac=function(i){return new(i||e)(f(L),f(It),f(F))};static \u0275cmp=w({type:e,selectors:[["app-payment"]],viewQuery:function(i,o){if(i&1&&(S($,5),S(Gt,5),S(N,5),S(le,5,z)),i&2){let l;v(l=x())&&(o.paginator=l.first),v(l=x())&&(o.sort=l.first),v(l=x())&&(o.table=l.first),v(l=x())&&(o.container=l.first)}},decls:44,vars:5,consts:[["input",""],[1,"table-container"],[1,"text-2xl","font-bold"],["mat-raised-button","","color","primary",1,"load-batch-btn",3,"click"],[1,"full-width"],["matInput","","placeholder","Search payment...",3,"keyup"],[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","applicationId"],["matColumnDef","typeOfPayment"],["matColumnDef","amount"],["matColumnDef","receiptNo"],["matColumnDef","paymentDate"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","space-x-2",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of payment",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-cell","",1,"space-x-2"],["mat-icon-button","","color","primary","matTooltip","View Payment Details",3,"click"],["mat-icon-button","","color","primary","matTooltip","Edit Payment",3,"click"],["mat-icon-button","","color","primary","matTooltip","Delete Payment",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(i,o){if(i&1){let l=P();a(0,"div",1)(1,"div")(2,"h1",2),r(3,"Payment"),n(),r(4," \xA0 "),a(5,"button",3),b("click",function(){return u(l),y(o.openDialog())}),r(6,"Add Payment"),n()(),r(7," \xA0 "),a(8,"div")(9,"mat-form-field",4)(10,"mat-label"),r(11,"Filter"),n(),a(12,"input",5,0),b("keyup",function(D){return u(l),y(o.applyFilter(D))}),n()()(),a(14,"div",6)(15,"table",7),g(16,8),c(17,ce,2,0,"th",9)(18,de,2,1,"td",10),_(),g(19,11),c(20,se,2,0,"th",9)(21,fe,2,1,"td",10),_(),g(22,12),c(23,ue,2,0,"th",9)(24,ye,2,1,"td",10),_(),g(25,13),c(26,ge,2,0,"th",9)(27,_e,3,3,"td",10),_(),g(28,14),c(29,be,2,0,"th",9)(30,Ce,2,1,"td",10),_(),g(31,15),c(32,Pe,2,0,"th",9)(33,he,3,4,"td",10),_(),g(34,16),c(35,Se,2,0,"th",9)(36,ve,2,1,"td",10),_(),g(37,17),c(38,xe,2,0,"th",18)(39,Me,10,0,"td",19),_(),c(40,De,1,0,"tr",20)(41,we,1,0,"tr",21)(42,Te,3,1,"tr",22),n(),C(43,"mat-paginator",23),n()()}i&2&&(m(15),p("dataSource",o.dataSource),m(25),p("matHeaderRowDef",o.displayedColumns),m(),p("matRowDefColumns",o.displayedColumns),m(2),p("pageSizeOptions",U(4,pe)))},dependencies:[B,R,A,k,Ht,N,Bt,Ft,At,kt,Lt,Rt,Nt,Vt,$t,jt,_t,gt,$,O,E,dt,Qt,zt,I,Z,X],styles:[".table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:300px;border:1.5px solid #e0e0e0;border-radius:10px;padding:24px;background:transparent;box-shadow:none}.load-batch-btn[_ngcontent-%COMP%]{height:50px;min-width:120px;margin-left:8px;background:#4169e1!important;color:#fff!important;font-weight:600;font-size:16px;border-radius:8px;box-shadow:0 2px 8px #4169e126;transition:background .2s,box-shadow .2s,transform .1s;letter-spacing:.5px;border:none;display:flex;align-items:left;justify-content:center;padding:0 24px;margin-bottom:24px}.load-batch-btn[_ngcontent-%COMP%]:hover, .load-batch-btn[_ngcontent-%COMP%]:focus{background:#274bb5!important;box-shadow:0 4px 16px #4169e140;transform:translateY(-2px) scale(1.03)}  .mat-header-cell{background-color:#3f51b5;color:#fff;font-weight:700;font-size:16px;text-align:center}  .mat-header-row{height:56px}.full-width[_ngcontent-%COMP%]{width:100%}table[_ngcontent-%COMP%], thead[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%], tr[_ngcontent-%COMP%], th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{background:transparent!important}.mat-elevation-z8[_ngcontent-%COMP%], .mat-table[_ngcontent-%COMP%], .mat-header-row[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%], .mat-header-cell[_ngcontent-%COMP%], .mat-cell[_ngcontent-%COMP%], tr[_ngcontent-%COMP%], td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{background:transparent!important;box-shadow:none!important}  .mat-paginator,   .mat-paginator-container,   .mat-paginator-outer-container,   .mat-paginator-range-actions,   .mat-paginator-page-size,   .mat-paginator-page-size-label,   .mat-paginator-range-label,   .mat-paginator-navigation-previous,   .mat-paginator-navigation-next,   .mat-paginator-page-size-select,   .mat-paginator-page-size-select .mat-select-trigger,   .mat-paginator-page-size-select .mat-select-value,   .paginator-row,   div[style*=background],   .mat-mdc-paginator,   .mat-mdc-paginator-container,   .mat-mdc-paginator-range-actions{background:transparent!important;box-shadow:none!important}  .mat-paginator,   .mat-paginator-container,   .mat-paginator-outer-container,   .mat-mdc-paginator,   .mat-mdc-paginator-container{background:transparent!important;box-shadow:none!important;border:none!important}"]})};export{Jt as PaymentComponent};
