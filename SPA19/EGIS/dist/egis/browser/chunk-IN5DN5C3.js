import{c as I,e as mt,f as ct,g as st,h as ut}from"./chunk-4QXU7Q3Z.js";import{e as M,f as q,g as G,h as U,i as J,j as K,k as W,l as X,m as Z,n as tt,o as et,p as it,q as ot,r as at,s as nt,t as lt,u as rt}from"./chunk-MYHFZ2D2.js";import"./chunk-3RK6DDJD.js";import{$ as j,ga as B,la as $,ma as N,pa as Y,r as Q,ra as z,sa as L}from"./chunk-KTJ4FNCK.js";import{a as V,c as P}from"./chunk-XHFMZJAH.js";import{a as H}from"./chunk-IKLMD3RG.js";import{t as k}from"./chunk-T6TR6RQX.js";import{$ as E,Bb as a,Cb as n,Db as c,Eb as d,Fb as p,Hb as T,Lb as S,Mb as D,Qb as _,Rb as h,Sb as b,Va as m,Vb as A,W as R,Wb as l,Xb as v,Yb as w,_a as y,dc as O,fb as F,ia as f,ja as C,lb as s,sb as u}from"./chunk-5MRHDFKX.js";var g=class t{constructor(e){this.http=e}apibaseurl=ut.toimsApiBaseURL;getCollectionByCodeMonthYear(e,i,o){let r={code:e,month:i,year:o};return this.http.get(this.apibaseurl+"/Collectionsummarydetails/GetDetails/",{params:r})}deleteCollection(e){return this.http.delete(`${this.apibaseurl+"/CheckReceivedDay"}/${e}`)}static \u0275fac=function(i){return new(i||t)(E(H))};static \u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"})};var yt=()=>[5,10,25,100];function St(t,e){t&1&&(a(0,"th",23),l(1,"Description"),n())}function Dt(t,e){if(t&1&&(a(0,"td",24),l(1),n()),t&2){let i=e.$implicit;m(),v(i.id)}}function _t(t,e){t&1&&c(0,"td",25)}function ht(t,e){t&1&&(a(0,"th",23),l(1,"Description"),n())}function bt(t,e){if(t&1&&(a(0,"td",24),l(1),n()),t&2){let i=e.$implicit;m(),v(i.setDate)}}function vt(t,e){t&1&&c(0,"td",25)}function wt(t,e){t&1&&(a(0,"th",23),l(1,"Amount"),n())}function Mt(t,e){if(t&1&&(a(0,"td",26),l(1),n()),t&2){let i=e.$implicit;m(),v(i.perDayAmount)}}function gt(t,e){if(t&1&&(a(0,"td",27)(1,"b"),l(2),n()()),t&2){let i=D();m(2),w("Total: ",i.totalAmount,"")}}function xt(t,e){t&1&&(a(0,"th",23),l(1," Action "),n())}function Tt(t,e){if(t&1){let i=T();a(0,"td",28)(1,"button",29),S("click",function(){let r=f(i).$implicit,x=D();return C(x.deleteCollection(r.id))}),a(2,"mat-icon"),l(3,"delete"),n()()()}}function It(t,e){t&1&&c(0,"td",25)}function Rt(t,e){t&1&&c(0,"tr",30)}function Et(t,e){t&1&&c(0,"tr",31)}function Ft(t,e){t&1&&c(0,"tr",32)}function At(t,e){if(t&1&&(a(0,"tr",33)(1,"td",34),l(2),n()()),t&2){D();let i=A(9);m(2),w('No data matching the filter "',i.value,'"')}}var dt=class t{constructor(e,i,o){this.route=e;this.router=i;this.collectionSummaryDetailsService=o}selectedCode;selectedMonth;selectedYear;showSubCode=!1;totalAmount=0;displayedColumns=["setDate","perDayAmount","actions"];dataSource;paginator;sort;table;ngOnInit(){this.route.params.subscribe(e=>{this.selectedCode=e.code,this.selectedMonth=+e.month,this.selectedYear=+e.year,this.loadCollectionSummaryDetails()})}loadCollectionSummaryDetails(){this.collectionSummaryDetailsService.getCollectionByCodeMonthYear(this.selectedCode,this.selectedMonth,this.selectedYear).subscribe(e=>{this.dataSource=new rt(e),this.calculateTotals(e),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}calculateTotals(e){console.log("Calculating totals for data:",e),this.totalAmount=e.reduce((i,o)=>i+(o.perDayAmount||0),0),console.log("Total Amount:",this.totalAmount)}applyFilter(e){let i=e.target.value;this.dataSource.filter=i.trim().toLowerCase()}goToCollectionSummary(){this.router.navigate(["/mainlayout/collectionsummary"]),this.showSubCode=!0}deleteCollection(e){confirm("Are you sure you want to delete this Collection?")&&this.collectionSummaryDetailsService.deleteCollection(e).subscribe(()=>{this.loadCollectionSummaryDetails()})}static \u0275fac=function(i){return new(i||t)(y(V),y(P),y(g))};static \u0275cmp=F({type:t,selectors:[["app-collection-summary-details"]],viewQuery:function(i,o){if(i&1&&(_(I,5),_(mt,5),_(M,5)),i&2){let r;h(r=b())&&(o.paginator=r.first),h(r=b())&&(o.sort=r.first),h(r=b())&&(o.table=r.first)}},decls:36,vars:7,consts:[["input",""],[1,"table-container"],[1,"text-2xl","font-bold"],[1,"full-width"],["matInput","","placeholder","Search collection details...",3,"keyup"],[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","ID"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","setDate"],["matColumnDef","perDayAmount"],["mat-cell","","align","right",4,"matCellDef"],["mat-footer-cell","","align","right",4,"matFooterCellDef"],["matColumnDef","actions"],["mat-cell","","class","space-x-2",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of users",3,"pageSizeOptions"],["mat-raised-button","","color","primary",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-footer-cell",""],["mat-cell","","align","right"],["mat-footer-cell","","align","right"],["mat-cell","",1,"space-x-2"],["mat-icon-button","","color","primary",3,"click"],["mat-header-row",""],["mat-row",""],["mat-footer-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(i,o){if(i&1){let r=T();a(0,"div",1)(1,"div")(2,"h1",2),l(3),n()(),a(4,"div")(5,"mat-form-field",3)(6,"mat-label"),l(7,"Filter"),n(),a(8,"input",4,0),S("keyup",function(pt){return f(r),C(o.applyFilter(pt))}),n()()(),a(10,"div",5)(11,"table",6),d(12,7),s(13,St,2,0,"th",8)(14,Dt,2,1,"td",9)(15,_t,1,0,"td",10),p(),d(16,11),s(17,ht,2,0,"th",8)(18,bt,2,1,"td",9)(19,vt,1,0,"td",10),p(),d(20,12),s(21,wt,2,0,"th",8)(22,Mt,2,1,"td",13)(23,gt,3,1,"td",14),p(),d(24,15),s(25,xt,2,0,"th",8)(26,Tt,4,0,"td",16)(27,It,1,0,"td",10),p(),s(28,Rt,1,0,"tr",17)(29,Et,1,0,"tr",18)(30,Ft,1,0,"tr",19)(31,At,3,1,"tr",20),n(),c(32,"mat-paginator",21),n(),a(33,"div")(34,"button",22),S("click",function(){return f(r),C(o.goToCollectionSummary())}),l(35,"Go to Collection Summary"),n()()()}i&2&&(m(3),w("Collection Summary Details: ",o.selectedCode," "),m(8),u("dataSource",o.dataSource),m(17),u("matHeaderRowDef",o.displayedColumns),m(),u("matRowDefColumns",o.displayedColumns),m(),u("matFooterRowDef",o.displayedColumns),m(2),u("pageSizeOptions",O(6,yt)))},dependencies:[N,$,B,j,lt,M,G,Z,J,q,et,U,tt,K,X,W,it,at,ot,nt,st,ct,I,L,z,Y,k,Q],styles:[".table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:300px}  .mat-header-cell{background-color:#3f51b5;color:#fff;font-weight:700;font-size:16px;text-align:center}  .mat-header-row{height:56px}.full-width[_ngcontent-%COMP%]{width:100%}.button-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.button-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:8px}"]})};export{dt as CollectionSummaryDetailsComponent};
